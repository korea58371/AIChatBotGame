{
  "meta": {
    "project": "AIChatBotGame Login & Account Management",
    "date": "2026-01-15",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "AIChatBotGame provides a dual-mode authentication system supporting both Guest and User (email/social login) access, enabling persistent user data and seamless account management including login, logout, account linking, and withdrawal.",
  "core_goals": [
    "Enable anonymous guest login to start gameplay quickly without authentication.",
    "Provide robust OAuth and email-based login with Supabase Auth for user accounts.",
    "Allow guests to upgrade their accounts by linking to an authenticated User account without data loss.",
    "Facilitate secure logout flows for both Guest and User with appropriate data handling and UI warnings.",
    "Implement account withdrawal functionality ensuring complete user data and authentication removal.",
    "Deliver responsive UI/UX in the Settings modal reflecting user status, coins, and appropriate action buttons.",
    "Guarantee data persistence for logged-in users and warn guests about data loss risks.",
    "Maintain secure server-side deletion with service role key and RLS bypass for withdrawal requests."
  ],
  "key_features": [
    "Guest login automatically authenticates users anonymously on game start without manual login.",
    "OAuth login integration with Google, Kakao, and email allowing users to authenticate securely.",
    "Logout functionality distinct for Guest and User, with guest logout warning about potential data loss.",
    "Account linking feature enabling guests to convert their session to a full user account without losing game progress.",
    "Account withdrawal flow with confirmation popups and server-side deletion of user profiles and related gameplay data.",
    "Settings modal UI reflecting user login state, showing coins, and dynamically displaying login, linking, logout, or withdrawal buttons accordingly.",
    "Backend server action handling critical operations like account deletion using secure service role tokens.",
    "Session management ensuring redirect to main screen after login, logout, or withdrawal operations."
  ],
  "user_flow_summary": [
    "User lands on Title Screen and can start game as Guest with anonymous authentication in background.",
    "User accesses Settings Modal to log in via OAuth/email or sign up if currently not logged in.",
    "Guest users can link their account from Settings to upgrade to full User account without losing progress.",
    "Users can log out from Settings; Guests see a warning about data loss prior to logout, Users logout securely preserving data.",
    "Users who are logged in can initiate account withdrawal from Settings, confirming before destructive data operations.",
    "After logout or withdrawal, user is redirected to Title Screen.",
    "UI updates dynamically to show correct user status, email or guest ID, coin balance, and action buttons based on authentication state."
  ],
  "validation_criteria": [
    "Guest login triggers anonymous authentication and session is maintained until logout.",
    "OAuth login flow completes with session cookies issued and redirection to previous page.",
    "Logout for Guest shows data loss warning and terminates guest session, redirecting user appropriately.",
    "Logout for User destroys session but preserves data, redirecting user to main screen.",
    "Account linking upgrades guest session to user session without losing game data.",
    "Account withdrawal calls backend deleteAccount action which deletes user profile, gameplay logs, saves, and authentication account, then logs out session.",
    "Settings modal UI reflects accurate status: Not Logged In, Guest with ID, or User with email, and displays correct coin balance.",
    "Action buttons in settings modal are correct for current user state and perform expected login, linking, logout, or withdrawal.",
    "Backend server actions use service role key and bypass RLS to ensure full data deletion for withdrawal.",
    "All critical flows tested including guest login, user login, logout, account linking, and account withdrawal."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Next.js",
      "React",
      "Supabase",
      "TailwindCSS",
      "Zustand",
      "Framer Motion"
    ],
    "features": [
      {
        "name": "Login Component",
        "description": "Handles user authentication including Guest login and OAuth.",
        "files": [
          "src/components/Login.tsx",
          "src/app/auth/callback/route.ts"
        ]
      },
      {
        "name": "Title Screen",
        "description": "Main entry screen, manages session state, game starting, and modal visibility.",
        "files": [
          "src/components/TitleScreen.tsx"
        ]
      },
      {
        "name": "Settings Modal",
        "description": "Displays user settings including Account Info (Coin balance, Email/Guest ID) and System options.",
        "files": [
          "src/components/visual_novel/ui/SettingsModal.tsx"
        ]
      }
    ]
  }
}
