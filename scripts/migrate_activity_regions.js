/**
 * Migration Script: Convert 활동지역 from string to array with spot-level detail
 * Run: node scripts/migrate_activity_regions.js
 */
const fs = require('fs');
const path = require('path');

// Mapping: Character Name → Array of activity regions with spot-level detail
const MAIN_MAPPING = {
    // === 메인 히로인 ===
    "천서윤": ["서울 > 오림푸스 > 길드장실", "서울 > 오림푸스 > 훈련장", "서울 > 관리국 > 회의실", "서울 > 강남 > 레스토랑"],
    "유화영": ["서울 > 관리국 > 제3팀_사무실", "서울 > 관리국 > 취조실", "서울 > 강남 > LP바", "서울 > 강남 > 클럽"],
    "이아라": ["서울 > 방송국 > 개인스튜디오", "서울 > 방송국 > 대기실", "서울 > 강남 > 번화가", "서울 > 강남 > 백화점"],
    "은하율": ["서울 > 아카데미 > 훈련장", "서울 > 오림푸스 > 훈련장", "서울 > 주거지 > 공원_강변"],
    "한수진": ["서울 > 관리국 > 지하_연구소", "서울 > 오림푸스 > 휴게실"],
    "데스피나": ["이면세계 > 붉은_성 > 알현실", "이면세계 > 붉은_성 > 피의_정원", "서울 > 강남 > 호텔_로비"],
    "백련화": ["서울 > 아카데미 > 훈련장", "서울 > 아카데미 > 강의실", "서울 > 아카데미 > 도서관"],
    "키리": ["일본 > 도쿄 > 아키하바라", "일본 > 도쿄 > 신주쿠_거리", "던전 > 필드"],
    "신세아": ["서울 > 강남 > 백화점", "서울 > 강남 > 레스토랑", "서울 > 강남 > 호텔_로비", "서울 > 강남 > 카지노_로얄"],
    "성시아": ["서울 > 성녀청 > 대성당", "서울 > 성녀청 > 기도실", "서울 > 성녀청 > 고해소"],
    "도예린": ["서울 > 강남 > 번화가", "서울 > 주거지"],
    "비올라": ["네오_아카디아 > 본부 > 작전실", "서울 > 강남 > 클럽", "서울 > 강남 > 호텔_로비"],
    "한가을": ["서울 > 주거지 > 주인공집_반지하", "서울 > 아카데미 > 도서관", "서울 > 주거지 > 카페_아늑한"],

    // === 서브 히로인 (한국) ===
    "엘레나 로즈바이스": ["서울 > 아카데미 > 훈련장", "서울 > 오림푸스 > 훈련장", "서울 > 강남 > 레스토랑"],
    "서유나": ["서울 > 강남 > 번화가", "서울 > 주거지 > 카페_아늑한", "서울 > 주거지 > 공원_강변"],
    "주아인": ["서울 > 아카데미 > 훈련장", "서울 > 오림푸스 > 훈련장", "서울 > 강남 > 번화가"],
    "윤슬비": ["서울 > 주거지 > 카페_아늑한", "서울 > 아카데미 > 도서관", "서울 > 주거지 > 공원_강변"],
    "민소희": ["서울 > 주거지 > 민소희집_거실", "서울 > 주거지 > 주인공집_반지하"],
    "아나스타샤 이바노바": ["서울 > 강남 > 클럽", "서울 > 강남 > LP바", "서울 > 오림푸스 > 훈련장", "던전 > 필드"],
    "아미라 알 라시드": ["서울 > 강남 > 백화점", "서울 > 강남 > 호텔_로비", "서울 > 강남 > 레스토랑"],
    "키사라기 사쿠라코": ["일본 > 도쿄 > 신주쿠_거리", "서울 > 강남 > 클럽"],
    "강지수": ["서울 > 관리국 > 제3팀_사무실", "서울 > 관리국 > 취조실", "서울 > 강남 > 거리"],
    "김민지": ["서울 > 주거지 > 주인공집_반지하", "서울 > 주거지 > 카페_아늑한"],
    "설아": ["던전 > 필드", "서울 > 주거지 > 공원_강변", "서울 > 주거지 > 놀이터_낡은"],
    "마세영": ["서울 > 주거지 > 편의점", "서울 > 아카데미 > 훈련장", "던전 > 필드"],
    "고하늘": ["서울 > 주거지 > 편의점", "던전 > 필드", "서울 > 강남 > 번화가"],
    "오지민": ["서울 > 관리국 > 국장실", "서울 > 관리국 > 회의실", "서울 > 강남 > LP바"],
    "홍유리": ["서울 > 강남 > 카지노_로얄", "서울 > 강남 > 클럽", "서울 > 강남 > 번화가"],
    "클레어": ["서울 > 주거지 > 주인공집_반지하", "서울 > 성녀청 > 대성당", "서울 > 주거지 > 민소희집_거실"],
    "백소미": ["서울 > 주거지 > 편의점", "서울 > 주거지 > 카페_아늑한", "던전 > 필드"],
    "송민주": ["서울 > 강남 > 호텔_로비", "서울 > 강남 > 카지노_로얄", "서울 > 강남 > 레스토랑"],
    "차도희": ["서울 > 강남 > 레스토랑", "서울 > 관리국 > 회의실", "서울 > 강남 > LP바"],
    "한여름": ["서울 > 방송국 > 뉴스데스크", "서울 > 방송국 > 분장실", "서울 > 사계절길드 > 정원"],
    "권세나": ["서울 > 주거지 > 골목", "서울 > 강남 > 거리", "서울 > 주거지 > 편의점"],
    "송채윤": ["서울 > 관리국 > 지하_연구소", "서울 > 주거지", "서울 > 강남 > 번화가"],
    "장미래": ["서울 > 강남 > 번화가", "서울 > 강남 > 카지노_로얄", "서울 > 주거지 > 카페_아늑한"],
    "류소연": ["서울 > 오림푸스 > 로비", "서울 > 강남 > 레스토랑", "서울 > 관리국 > 회의실"],
    "한봄": ["서울 > 사계절길드 > 정원", "서울 > 아카데미 > 훈련장", "서울 > 주거지 > 공원_강변"],
    "이화연": ["서울 > 강남 > 번화가", "서울 > 주거지 > 공원_강변"],
    "서이수": ["서울 > 주거지 > 골목", "서울 > 주거지 > 빈민가", "서울 > 강남 > 클럽"],

    // === 일본 캐릭터 ===
    "사이온지 미유키": ["일본 > 교토 > 오래된신사", "일본 > 교토 > 전통찻집"],
    "타나카 아이": ["일본 > 도쿄 > 신주쿠_거리", "일본 > 도쿄 > 아키하바라"],
    "사토 아야": ["일본 > 도쿄 > 아키하바라", "던전 > 필드"],
    "야마다 하나코": ["일본 > 도쿄 > 신주쿠_거리", "일본 > 도쿄 > 아키하바라"],

    // === 특수/외국 캐릭터 ===
    "백마리": ["서울 > 관리국 > 취조실", "서울 > 관리국", "서울 > 강남 > 클럽"],
    "신유라": ["서울 > 관리국 > 지하_연구소", "서울 > 병원 > 진료실", "서울 > 성녀청 > 대성당"],
    "리메이링": ["중국 > 상하이 > 와이탄", "중국 > 상하이 > 금융가"],
    "링링": ["중국 > 베이징 > 자금성", "중국 > 베이징 > 후퉁"],
    "왕웨이": ["중국 > 상하이 > 금융가", "서울 > 강남 > 카지노_로얄"],
    "제시카": ["미국 > 뉴욕 > 타임스퀘어", "미국 > 뉴욕 > 헌터협회_본부"],
    "강하은": ["부산 > 해운대 > 해수욕장", "부산 > 부산항 > 어시장"],
    "고수아": ["제주 > 한라산 > 백록담", "제주 > 한라산 > 등산로", "제주 > 서귀포 > 감귤농장"],
};

const SUPPORTING_MAPPING = {
    "정한수": ["서울 > 주거지 > 주인공집_반지하", "서울 > 주거지 > 편의점", "서울 > 강남 > 만화카페"],
    "윤아름": ["서울 > 주거지 > 편의점", "서울 > 주거지 > 카페_아늑한"],
    "최시우": ["서울 > 강남 > 클럽", "서울 > 강남 > 레스토랑", "서울 > 아카데미 > 강의실"],
    "박채린": ["서울 > 강남 > 백화점", "서울 > 강남 > 번화가", "서울 > 강남 > 미용실"],
    "이지연": ["서울 > 강남 > 레스토랑", "서울 > 강남 > 호텔_로비", "서울 > 주거지"],
    "김채은": ["서울 > 아카데미 > 훈련장", "서울 > 아카데미 > 도서관"],
    "박봄": ["서울 > 아카데미 > 강의실", "서울 > 아카데미 > 기숙사2인실"],
};

function migrateFile(filePath, mapping) {
    const raw = fs.readFileSync(filePath, 'utf-8');
    const data = JSON.parse(raw);

    let updated = 0;
    let skipped = [];

    for (const [name, charData] of Object.entries(data)) {
        if (mapping[name]) {
            charData['활동지역'] = mapping[name];
            updated++;
        } else {
            skipped.push(name);
        }
    }

    // Write with pretty print (2 space indent, match original)
    fs.writeFileSync(filePath, JSON.stringify(data, null, 4), 'utf-8');

    console.log(`✅ ${path.basename(filePath)}: ${updated} characters updated`);
    if (skipped.length > 0) {
        console.log(`⚠️ Skipped (no mapping): ${skipped.join(', ')}`);
    }
}

const mainPath = path.join(__dirname, '../src/data/games/god_bless_you/jsons/characters/characters_main.json');
const supportPath = path.join(__dirname, '../src/data/games/god_bless_you/jsons/characters/characters_supporting.json');

console.log('=== Migrating 활동지역 to Array Format ===\n');
migrateFile(mainPath, MAIN_MAPPING);
migrateFile(supportPath, SUPPORTING_MAPPING);
console.log('\n=== Done ===');
