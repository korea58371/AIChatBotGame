
const fs = require('fs');

const files = [
    'j:/AI/Game/AIChatBotGame/src/data/games/wuxia/jsons/characters/characters_main.json',
    'j:/AI/Game/AIChatBotGame/src/data/games/wuxia/jsons/characters/characters_supporting.json'
];

const atomicTags = {
    // --- Main Characters ---
    "연화린": ["북해빙궁", "빙궁", "소궁주", "오룡육봉", "빙백신권", "냉혈검희", "빙설화", "백금발"],
    "백소유": ["아미파", "아미", "대제자", "오룡육봉", "멸절검법", "절대기억", "천재", "검수"],
    "화영": ["화산파", "화산", "매화검수", "오룡육봉", "이십사수매화검법", "매화", "검수", "정통"],
    "남궁세아": ["남궁세가", "남궁", "오룡육봉", "제왕건곤검", "가출", "소녀", "검수"],
    "모용예린": ["모용세가", "모용", "오룡육봉", "수라선법", "요정", "단검"],
    "당소율": ["사천당가", "당가", "오룡육봉", "만천화우", "독왕_딸", "독", "소녀"],
    "천예령": ["천마신교", "마교", "성녀", "소교주", "오룡육봉", "천마신공", "적안"],
    "제갈연주": ["제갈세가", "제갈", "가주대행", "오룡육봉", "팔진도", "천재", "군사", "지략"],
    "주예서": ["황실", "공주", "황녀", "금위위", "잠행", "황족"],
    "한설희": ["빙궁", "호위", "한빙장", "충성"],
    "홍유비": ["개방", "거지", "타구봉법", "장로", "정보"],
    "공손란": ["검무", "공손", "무희", "검", "춤"],
    "비연": ["살수", "암살자", "비검", "그림자"],
    "설하은": ["구음절맥", "설가", "객잔", "병약", "절맥"],
    "야율": ["북방", "이민족", "전사", "부족"],
    "팽소소": ["하북팽가", "팽가", "근육", "괴력", "오룡육봉", "도법"],
    "도무아": ["도적", "산적", "여두목", "쌍도"],
    "금채월": ["대통상회", "상인", "돈", "갑부_딸", "정보"],
    "소야": ["신비", "소녀", "기억상실", "영물"],

    // --- Supporting Characters (Major) ---
    "독고천": ["무림맹", "맹주", "독고세가", "검황", "독고구검", "천하제일인"],
    "천위강": ["천마신교", "마교", "교주", "천마", "절대자", "천마신공", "아빠"],
    "남궁천": ["남궁세가", "남궁", "가주", "뇌제", "오대세가", "제왕건곤검", "아버지"],
    "장무극": ["패천맹", "맹주", "흑제", "사파", "패천마공", "암흑가"],
    "금만수": ["대통상회", "상회주", "갑부", "돈", "황금", "딸바보"],
    "남궁진": ["남궁세가", "남궁", "소가주", "창궁검", "후기지수", "엘리트"],
    "모용휘": ["모용세가", "모용", "소가주", "수라선", "책사", "부채"],
    "당보": ["사천당가", "당가", "비도", "천재", "독비", "장난"],
    "팽대광": ["하북팽가", "팽가", "소가주", "광룡", "오호단문도", "근육"],
    "주진양": ["아미파", "아미", "이대제자", "멸절검법", "질투", "라이벌"],
    "팽무도": ["하북팽가", "팽가", "가주", "도왕", "오대세가", "혼원벽력도"],
    "당문식": ["사천당가", "당가", "가주", "독왕", "오대세가", "만독불침"],
    "야율 바르칸": ["북방", "이민족", "야수왕", "권왕", "사황"],

    // --- Supporting Characters (Minor/Groups) ---
    "무영": ["그림자", "호위", "암살"],
    "현명": ["소림사", "소림", "방장", "스님", "권법"],
    "현무": ["소림사", "소림", "무승", "금강불괴"],
    "운검": ["화산파", "장로", "검수"],
    "정허": ["무당파", "무당", "장문인", "태극권"],
    "공손월": ["매화", "검수", "화산"],
    "홍칠": ["개방", "방주", "거지", "타구봉"],
    "당명": ["당가", "독", "장로"],
    "남궁휘": ["남궁", "장로", "검"],
    "혈비": ["마교", "호위", "혈공"],
    "흑풍": ["마교", "행동대장", "바람"],
    "혜심": ["아미파", "장문인", "비구니"],
    "청운": ["무당", "도사", "검"],
    "유성": ["점창파", "검수", "쾌검"],
    "왕초": ["개방", "거지", "정보"],
    "당비": ["당가", "여인", "독"],
    "남궁혁": ["남궁", "호위", "충직"],
    "모용구": ["모용", "장로", "꼰대"],
    "도끼": ["산적", "도끼", "힘"],
    "조명": ["상인", "객잔", "주인"],
    "한철": ["대장장이", "무기", "철"],
    "왕노야": ["마을", "촌장", "노인"],
    "박철": ["광부", "힘", "일꾼"],
    "소칠": ["점소이", "서빙", "정보"],
    "조삼": ["일꾼", "짐꾼"],
    "연성": ["무사", "호위"],
    "명심": ["의원", "치료", "침"],
    "김포": ["포졸", "관아", "창"],
    "개눈": ["정보상", "뒷골목", "눈"],
    "초련": ["기녀", "정보", "미모"],
    "돌쇠": ["머슴", "힘", "충직"],
    "칠성": ["건달", "주먹", "패거리"],
    "왕곡추": ["개방", "장로", "거지"],
    "고준": ["청성파", "장문인", "검"],
    "마광철": ["흑도", "두목", "도"],
    "약선": ["의원", "신의", "치료"],
    "조윤": ["공동파", "장문인", "검"],
    "철우": ["소림", "무승", "권"],
    "매향": ["기녀", "미모", "악기"],
    "고칠성": ["점소이", "국수", "요리"],
    "혈수": ["사파", "살수", "손"],
    "삼칠": ["약초꾼", "산", "약초"],
    "유선": ["악사", "피리", "음공"],
    "진명": ["화산", "제자", "검"],
    "혜광": ["소림", "승려", "불경"],
    "사천패": ["사파", "폭력", "두목"],
    "독고미": ["독고", "가문", "검"],
    "구철": ["대장장이", "검", "제작"],
    "유환": ["환술사", "마술", "눈속임"],
    "장소": ["서생", "책", "공부"],
    "백골": ["사파", "해골", "독"],
    "단검": ["살수", "단검", "암살"],
    "모용현": ["모용", "검", "책사"],
    "제갈공": ["제갈", "장로", "진법"],
    "현암대사": ["소림", "원로", "불심"],
    "청허도장": ["무당", "원로", "도"],
    "청풍": ["무당", "제자", "검"],
    "절심사태": ["아미", "장로", "검"],
    "운중자": ["곤륜파", "장문인", "도"],
    "곽윤": ["종남파", "장문인", "검"],
    "운현": ["화산", "원로", "매화"],
    "홍거": ["개방", "장로", "거지"],
    "수왕": ["남만", "야수", "왕"],
    "모산도인": ["도사", "부적", "술법"],
    "상관무": ["금전방", "방주", "돈"],
    "연중경": ["북해빙궁", "궁주", "연화린_아버지", "빙공", "왕"],
    "연무린": ["북해빙궁", "오빠", "왕자", "빙공"],
    "금륜법왕": ["몽골", "국사", "무공"],
    "황보숭": ["황보세가", "가주", "권"],
    "흑룡": ["해적", "선장", "바다"],
    "왕일도": ["도적", "두목", "도"],
    "사마혁": ["사마세가", "가주", "책사"],
    "조태식": ["관군", "대장", "창"],
    "유소": ["신비", "고수", "은거"],
    "마강철": ["마교", "전사", "도"],
    "홍연화": ["마교", "여고수", "채찍"],
    "진소민": ["정파", "여협", "검"],
    "당무문": ["사천당가", "당가", "아들", "독"],
    "제갈현": ["제갈세가", "가주", "진법"],
    "진금영": ["금검", "고수", "검"],
    "악천": ["악인", "살수", "검"],
    "적호": ["산적", "호랑이", "힘"],
    "서문기": ["서문세가", "가주", "검"],
    "단우혈": ["혈교", "교주", "혈공"],
    "묘선": ["신녀", "치유", "선녀"],
    "청아": ["도사", "제자", "검"],
    "현오": ["소림", "제자", "권"],
    "설담": ["설가", "가주", "아버지"],
    "백학": ["무당", "도사", "학"],
    "천응": ["매", "조련", "사냥"]
};

files.forEach(filePath => {
    try {
        if (!fs.existsSync(filePath)) {
            console.log(`File not found: ${filePath}`);
            return;
        }

        const raw = fs.readFileSync(filePath, 'utf8');
        const data = JSON.parse(raw);
        let modified = false;

        for (const name in data) {
            const char = data[name];

            // Check if we have specific atomic tags for this character
            if (atomicTags[name]) {
                if (!char.system_logic) {
                    char.system_logic = {};
                }

                // Compare existing tags with new ones to see if change matches
                const currentTags = JSON.stringify(char.system_logic.tags || []);
                const newTags = JSON.stringify(atomicTags[name]);

                if (currentTags !== newTags) {
                    char.system_logic.tags = atomicTags[name];
                    modified = true;
                    console.log(`Updated tags for: ${name} -> [${atomicTags[name].join(", ")}]`);
                }
            } else {
                // If character not in list, log it so we know
                console.log(`Skipped (No atomic tags defined): ${name}`);
            }
        }

        if (modified) {
            fs.writeFileSync(filePath, JSON.stringify(data, null, 4), 'utf8');
            console.log(`Saved changes to ${filePath}`);
        } else {
            console.log(`No changes needed for ${filePath}`);
        }

    } catch (err) {
        console.error(`Error processing ${filePath}:`, err);
    }
});
